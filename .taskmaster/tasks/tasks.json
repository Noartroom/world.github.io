{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "Develop Device Power Strategy",
        "description": "Develop a strategy for low and high power devices using deviceStore. Define thresholds for switching to fallback mode (SVG).",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 2,
        "title": "Implement SVG Fallback for Low Power",
        "description": "Implement a fallback layer that renders an SVG of the model instead of the 3D scene for low-power devices. Ensure transition is smooth or initial load selects correct mode.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 3,
        "title": "Rust Code Cleanup & Optimization",
        "description": "Review src/lib.rs and other Rust files. Remove procedural mesh generation (create_sphere_mesh) if unused/replaced by GLB. Remove unnecessary logging (console_log) and update/clean up dependencies in cargo.toml.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 4,
        "title": "Mobile Touch & Performance Optimization",
        "description": "Improve touch interaction performance and responsiveness in both the UI (index.astro) and 3D scene (lib.rs/Renderer).",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 5,
        "title": "Optimize Service Workers",
        "description": "Investigate current Service Worker usage (if any) and implement/optimize caching strategies for assets (GLB, textures) to improve load performance on mobile.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 6,
        "title": "Fix Time Display Accuracy",
        "description": "Fix the time display in index.astro to show the actual current system time on load, and ensure updates are accurate (minutes, not just hours).",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 7,
        "title": "Audio Store Cleanup",
        "description": "Analyze src/lib/stores/audioStore.ts. Determine if it's still needed for visualization without IAMF. Remove if redundant or refactor.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 8,
        "title": "Review and improve Accessibility",
        "description": "Audit and improve accessibility compliance focusing on ARIA labels, keyboard navigation, and HTML5 landmarks.",
        "details": "Requirements:\n1. Add ARIA labels: Ensure [role]s have all required [aria-*] attributes. Specific target: div#time-display.global-toggle.time-control.\n2. Improve keyboard navigation: Ensure interactive controls are keyboard focusable.\n3. Interactive elements must indicate their purpose and state.\n4. Ensure logical tab order.\n5. Visual order on the page should follow DOM order.\n6. Prevent accidental focus traps.\n7. Direct user focus to new content added to the page.\n8. Use HTML5 landmark elements to improve navigation.\n9. Hide offscreen content from assistive technology.\n10. Ensure custom controls have associated labels and ARIA roles.",
        "testStrategy": "Manual verification using keyboard navigation and screen reader tools (e.g., VoiceOver, NVDA). Code review for ARIA attributes.",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Fix Time Control ARIA Attributes",
            "description": "Add `aria-valuenow` to `#time-display` and ensure it updates dynamically with JS when the time changes. Also add `aria-valuetext` for human-readable time.",
            "details": "",
            "status": "done",
            "dependencies": [],
            "parentTaskId": 8
          },
          {
            "id": 2,
            "title": "Improve Toggle Button Accessibility",
            "description": "Add `aria-pressed` attributes to `#blob-toggle`, `#themeToggle`, and `#modelToggle` where appropriate to indicate state. Ensure all buttons have accessible names.",
            "details": "",
            "status": "done",
            "dependencies": [],
            "parentTaskId": 8
          },
          {
            "id": 3,
            "title": "Manage Focus/Visibility for Layers",
            "description": "Implement `inert` or `aria-hidden` toggling for `#layer-back` and `#layer-front` when they are inactive to prevent focus traps in hidden content.",
            "details": "",
            "status": "done",
            "dependencies": [],
            "parentTaskId": 8
          },
          {
            "id": 4,
            "title": "Improve Document Structure and Landmarks",
            "description": "Wrap global controls in a `<nav>` or `<aside>` with an aria-label. Ensure proper landmark usage in Layout.astro.",
            "details": "",
            "status": "done",
            "dependencies": [],
            "parentTaskId": 8
          }
        ]
      },
      {
        "id": 9,
        "title": "Fix Firefox Dynamic Light Bug",
        "description": "Fix dynamic light/theme issue in Firefox by deferring lighting update.",
        "details": "The previous fix for dynamic lighting persistence across theme changes worked in Safari but failed in Firefox. This was likely due to a race condition where the theme reset in the renderer overwrote the lighting update.\n\nFix applied: Wrapped `updateTimeOfDay` in `requestAnimationFrame` within the theme subscription in `Renderer.astro` to ensure it runs after the theme update is processed.",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 10,
        "title": "Fix Mobile Rendering Issues (Safari/Firefox)",
        "description": "Investigate and fix mobile rendering issues on Safari and Firefox. User reports unknown error on Safari and background cube line glitches on Firefox. Suspects recent world/nav layer changes.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 11,
        "title": "Enhance Navigation & Mobile Visibility",
        "description": "Re-enable mobile background room and set initial coordinates to (1,0,0). Enhance navigation visual effect from (0,0,0) to (0,0,1).",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 12,
        "title": "Enhance Vertical Navigation Transition",
        "description": "Enhance visual effect for navigation from (0,0,0) to (0,0,1) to look like moving to a room \"above\". Remove complex bezier and scale transform, replace with large vertical translation.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 13,
        "title": "Enhance Down Navigation Transition",
        "description": "Apply vertical translation effect for navigating \"Down\" (0,0,1 -> 0,0,0). Replace scale/bezier transforms with translateY(0) restoration for layer-back and bg-layer-back.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 14,
        "title": "Synchronize Vertical Navigation Animations",
        "description": "Implement vertical sliding transition for #layer-front and #bg-layer-front to match the back layer's elevator effect. Ensure front layer slides up when going down, and slides down when going up.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 15,
        "title": "Update Mobile Navigation Layout",
        "description": "Reposition mobile navigation elements: center nav cubes at bottom, move coordinates to top center. Apply only to mobile portrait mode.",
        "details": "",
        "testStrategy": "",
        "status": "done",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 16,
        "title": "Implement Horizontal Navigation Transition",
        "description": "Implement horizontal sliding transition for navigation between Back (0,0,0) and Right (1,0,0) layers. Add layer-right-active class logic and corresponding CSS transforms.",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      },
      {
        "id": 17,
        "title": "Fix WebGPU Browser Compatibility & Rust/WASM Optimization",
        "description": "Fix WebGPU compatibility issues preventing 3D model rendering in Chrome desktop and Safari mobile. Perform surgical optimizations, remove unused code, and add robustness checks to make website SOTA.",
        "details": "**Critical Issue:** Chrome desktop and Safari mobile are not rendering 3D models due to WebGPU compatibility error:\n\nError: `Failed to execute 'requestDevice' on 'GPUAdapter': The limit \"maxInterStageShaderComponents\" with a non-undefined value is not recognized.`\n\n**Root Cause:** In `src/renderer.rs` line 104, the code uses `wgpu::Limits::downlevel_webgl2_defaults()` which includes limits not recognized by all browsers. The `maxInterStageShaderComponents` limit is not supported in Chrome/Safari's WebGPU implementation.\n\n**Tasks:**\n1. **Fix WebGPU Device Request Limits:** Modify `renderer.rs` to use only browser-compatible limits. Remove or conditionally set `maxInterStageShaderComponents` and other potentially unsupported limits.\n2. **Add Browser-Specific Limit Handling:** Detect browser capabilities and adjust limits accordingly. Use adapter limits as reference rather than hardcoded defaults.\n3. **Improve Error Handling:** Add graceful fallback when WebGPU device creation fails, with better error messages and automatic fallback to WebGL.\n4. **Remove Unused Code:** Audit Rust codebase (lib.rs, renderer.rs, state.rs, uniforms.rs, resources.rs) for unused functions, imports, and dependencies.\n5. **WASM Bundle Optimization:** Review Cargo.toml dependencies, remove unused crates, optimize build flags for smaller WASM output.\n6. **Cross-Browser Testing:** Verify rendering works in Chrome, Safari (desktop/mobile), Firefox, Edge.\n7. **Robustness Checks:** Add validation for WebGPU feature support, adapter capabilities, and proper error recovery paths.\n\n**Key Files to Modify:**\n- `src/renderer.rs` (lines 104-121): Fix device request limits\n- `src/Cargo.toml`: Review and optimize dependencies\n- `src/lib.rs`: Remove unused code\n- `src/components/Renderer.astro`: Improve error handling and fallback logic",
        "testStrategy": "1. Test in Chrome desktop - verify 3D models render without errors\n2. Test in Safari mobile - verify 3D models render without errors\n3. Test in Firefox - ensure no regressions\n4. Test in Edge - ensure compatibility\n5. Verify WASM bundle size reduction\n6. Check browser console for any WebGPU warnings/errors\n7. Test fallback to WebGL when WebGPU fails\n8. Verify no unused code warnings in Rust compilation",
        "status": "in-progress",
        "dependencies": [],
        "priority": "high",
        "subtasks": []
      }
    ],
    "metadata": {
      "created": "2025-12-14T03:53:00.809Z",
      "description": "Default tasks context",
      "updated": "2025-12-21T21:40:58.883Z"
    }
  }
}