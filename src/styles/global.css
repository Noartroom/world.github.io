/* Based on your 'style.css' for modern light/dark theming 
*/
:root {
  /* let the browser know this has light and dark mode */
  color-scheme: light dark;

  /* Theme toggle variables from your file */
  --sun-color: black;
  --moon-color: transparent;
}

body {
  font: 16px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue",
    Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
  
  /* Use light-dark() functions for base colors */
  color: light-dark(#444, #fff);
  background-color: transparent;

  /* Make the app full-page */
  margin: 0;
  padding: 0;
  width: 100%;
  min-height: 100vh;

  /* Clicks go through Body to Canvas */
  pointer-events: none;
}

h1, h2, h3 {
  line-height: 1.2;
}

/* Interactive Elements stay clickable */
button, a, input, select, label {
  pointer-events: auto;
}

button {
  background-color: light-dark(#c9d1d9, #444);
  color: light-dark(#444, #c9d1d9);
  padding: 8px;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

a:link {
  color: light-dark(#58a6ff, #bf753d);
}
a:visited {
  color: light-dark(#434669, #785438);
}

/* Theme toggle styles from your 'style.css' */
.sun {
  fill: var(--sun-color, black);
}
.moon {
  fill: var(--moon-color, transparent);
}

/* Override themes (from your 'style.css') */
/* This is controlled by our theme button */
.dark-mode {
  color-scheme: only dark;
  --sun-color: transparent;
  --moon-color: white;
}

.light-mode {
  color-scheme: only light;
  --sun-color: black;
  --moon-color: transparent;
}

/* --- Dynamic Lighting Engine Styles --- */
/* Unified lighting system that affects both 3D canvas and HTML elements */

/* Global light position variables (set by Renderer.astro) */
:root {
  --light-x: 50vw;
  --light-y: 50vh;
  --light-intensity: 0;
}

/* Body overlay for ambient light effect - Theme-aware */
body.light-engine-active::before {
  content: '';
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 1; /* Behind UI elements but above canvas */
  
  /* Default: Dark theme colors (cool white) */
  background: radial-gradient(
    circle 800px at var(--light-x, 50vw) var(--light-y, 50vh),
    rgba(240, 245, 255, calc(0.15 * var(--light-intensity, 0))) 0%,
    rgba(200, 220, 255, calc(0.10 * var(--light-intensity, 0))) 30%,
    rgba(0, 0, 0, 0) 70%
  );
  
  transition: opacity 0.3s ease-out, background 0.3s ease-out;
  mix-blend-mode: screen;
}

/* Light theme: Warm white tones */
body.light-mode.light-engine-active::before {
  background: radial-gradient(
    circle 800px at var(--light-x, 50vw) var(--light-y, 50vh),
    rgba(255, 250, 240, calc(0.20 * var(--light-intensity, 0))) 0%,
    rgba(255, 240, 220, calc(0.12 * var(--light-intensity, 0))) 30%,
    rgba(0, 0, 0, 0) 70%
  );
}

/* Enhanced button lighting effects */
body.light-engine-active button {
  position: relative;
  overflow: visible;
}

/* Make all interactive elements respond to light */
body.light-engine-active .global-controls {
  /* Only update the glow intensity, all other styles are already applied */
  --panel-glow: calc(var(--light-intensity, 0) * 0.3);
}

/* Link lighting effects */
body.light-engine-active a {
  --light-dx: calc(var(--light-x, 50vw) - 50vw);
  --light-dy: calc(var(--light-y, 50vh) - 50vh);
  /* Simplified proximity: use intensity directly */
  --light-proximity: var(--light-intensity, 0);
  /* Theme-based glow: cool white for dark theme, warm white for light theme */
  text-shadow: 
    0 0 calc(5px * var(--light-intensity, 0) * var(--light-proximity)) rgba(240, 245, 255, calc(var(--light-intensity, 0) * var(--light-proximity) * 0.8)),
    0 1px 2px rgba(0, 0, 0, 0.5);
  transition: text-shadow 0.2s ease-out;
}